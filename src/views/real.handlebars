<main>
    <h1 class="bg-secondary text-center text-white w-100 mb-3">LOAD PRODUCT</h1>
    <section class="d-flex flex-column align-items-center w-100">
        <section class="w-50 mb-3 p-2" style="min-width: 300px; max-width:500px">
            <form method="post">
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="title" placeholder="Title">
                    <label for="title">Title</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="number" class="form-control" id="price" placeholder="Price">
                    <label for="price">Price</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="number" class="form-control" id="stock" placeholder="Quantity">
                    <label for="stock">Stock</label>
                </div>
                <div class="form-floating mb-3">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                        <option selected>Zapatillas</option>
                        <option value="1">Remeras</option>
                        <option value="2">Buzos</option>
                    </select>
                    <label for="floatingSelect">Category</label>
                </div>
                <div class="form-floating mb-3">
                    <input type="text" class="form-control" id="photo" placeholder="Photo URL">
                    <label for="photo">Photo URL</label>
                </div>
                <button type="button" class="btn btn-primary" id="product">UPLOAD</button>
            </form>
        </section>
        <section class="d-flex flex-wrap justify-content-center" id="products"></section>
    </section>
</main>

<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script>
    const socket = io();
    socket.on("products", data => {
        const template = data
            .map(each => ` <img style="width: 200px; height: 200px" src="${each.photo}" class="object-fit-cover" alt="${each.id}"> `)
            .reverse()
            .splice(0, 4)
            .join("")
        document.querySelector("#products").innerHTML = template
    })
    document.querySelector("#product").addEventListener("click", (event) => {
        const title = document.querySelector("#title").value
        const price = document.querySelector("#price").value
        const stock = document.querySelector("#stock").value
        const category = document.querySelector("#floatingSelect").value // Change from #category to #floatingSelect
        const photo = document.querySelector("#photo").value
        socket.emit("product", { title, price, stock, category, photo })
    })
</script>
